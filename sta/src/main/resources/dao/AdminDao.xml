<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sicnu.sta.dao.AdminDao">

    <select id="queryAllUser" resultType="User">
        select * from user
    </select>

    <select id="queryAllUserRole" resultType="UserRole">
        select user_role.user_id, user_role.role_id, email, user_name, role_name
        from user, role, user_role
        where user_role.user_id = user.user_id and user_role.role_id = role.role_id
    </select>

    <update id="updateUserRole">
        update user_role set role_id = #{roleId} where user_id = #{userId}
    </update>

    <select id="queryLogs" resultType="Map">
        select * from ${tableName} limit #{cnt}, #{pageSize}
    </select>

    <insert id="saveOpLog" parameterType="OpLog" useGeneratedKeys="true" keyProperty="eventId">
        insert into op_log(user_id, user_name, ip, params, method, operation, op_time)
        values (#{opLog.userId}, #{opLog.userName}, #{opLog.ip}, #{opLog.params}, #{opLog.method}, #{opLog.operation}, #{opLog.opTime})
    </insert>

    <select id="queryTotalLog" resultType="Integer">
        select count(*) from ${tableName}
    </select>

</mapper>